<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 é›™æœˆæ›†ç”¢ç”Ÿå™¨ (6å¼µç…§ç‰‡)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lunar-javascript/1.6.12/lunar.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft JhengHei', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 15px;
            text-align: center;
        }
        .header h1 {
            font-size: 22px;
            margin-bottom: 8px;
        }
        .header p {
            font-size: 14px;
        }
        .content {
            display: flex;
            flex-direction: column;
        }
        .sidebar {
            width: 100%;
            background: #f8f9fa;
            padding: 20px 15px;
            max-height: none;
        }
        .main {
            width: 100%;
            padding: 20px 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .section {
            margin-bottom: 20px;
        }
        .section h3 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 16px;
        }
        .form-group {
            margin-bottom: 12px;
        }
        .image-upload-group {
            display: grid;
            gap: 10px;
            margin-top: 10px;
        }
        .image-upload-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }
        .image-upload-item label {
            font-size: 13px;
            color: #667eea;
            font-weight: bold;
        }
        .image-upload-item input[type="file"] {
            margin-top: 5px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }
        input[type="text"],
        input[type="number"],
        input[type="file"],
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border 0.3s;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        input[type="range"] {
            width: 100%;
            margin-top: 5px;
        }
        .slider-value {
            color: #667eea;
            font-weight: bold;
            margin-left: 10px;
        }
        .radio-group {
            display: flex;
            gap: 15px;
            margin-top: 8px;
            flex-wrap: wrap;
        }
        .radio-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
            font-size: 14px;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
        }
        .checkbox-group label {
            margin: 0;
            font-weight: normal;
            font-size: 14px;
        }
        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 10px;
        }
        button:hover {
            transform: translateY(-2px);
        }
        button:active {
            transform: translateY(0);
        }
        #preview {
            max-width: 100%;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .info {
            text-align: center;
            color: #666;
            padding: 30px 15px;
            font-size: 14px;
        }
        .loading {
            text-align: center;
            padding: 30px 15px;
            color: #667eea;
            font-size: 16px;
        }
        .download-btn {
            margin-top: 15px;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            .header h1 {
                font-size: 32px;
                margin-bottom: 10px;
            }
            .header p {
                font-size: 16px;
            }
            .content {
                flex-direction: row;
                min-height: 600px;
            }
            .sidebar {
                width: 380px;
                overflow-y: auto;
                max-height: calc(100vh - 200px);
                padding: 30px;
            }
            .main {
                flex: 1;
                padding: 30px;
            }
            .section h3 {
                font-size: 18px;
            }
            label {
                font-size: 15px;
            }
            .info {
                padding: 40px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“… 2026 é›™æœˆæ›†ç”¢ç”Ÿå™¨</h1>
            <p>ä¸Šå‚³6å¼µåœ–ç‰‡ï¼Œæ¯å¼µå°æ‡‰å…©å€‹æœˆä»½ï¼</p>
        </div>
        <div class="content">
            <div class="sidebar">
                <div class="section">
                    <h3>1. ä¸Šå‚³6å¼µåœ–ç‰‡</h3>
                    <div class="image-upload-group">
                        <div class="image-upload-item">
                            <label>ğŸ“· 1-2æœˆåœ–ç‰‡</label>
                            <input type="file" id="img1" accept="image/*">
                        </div>
                        <div class="image-upload-item">
                            <label>ğŸ“· 3-4æœˆåœ–ç‰‡</label>
                            <input type="file" id="img2" accept="image/*">
                        </div>
                        <div class="image-upload-item">
                            <label>ğŸ“· 5-6æœˆåœ–ç‰‡</label>
                            <input type="file" id="img3" accept="image/*">
                        </div>
                        <div class="image-upload-item">
                            <label>ğŸ“· 7-8æœˆåœ–ç‰‡</label>
                            <input type="file" id="img4" accept="image/*">
                        </div>
                        <div class="image-upload-item">
                            <label>ğŸ“· 9-10æœˆåœ–ç‰‡</label>
                            <input type="file" id="img5" accept="image/*">
                        </div>
                        <div class="image-upload-item">
                            <label>ğŸ“· 11-12æœˆåœ–ç‰‡</label>
                            <input type="file" id="img6" accept="image/*">
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>2. æ¨™é¡Œè¨­å®š</h3>
                    <input type="text" id="customTitle" value="2026 æ°‘åœ‹115å¹´ æ­²æ¬¡ä¸™åˆ é¦¬å¹´" placeholder="è¼¸å…¥æ¨™é¡Œ">
                </div>

                <div class="section">
                    <h3>3. ç‰ˆé¢è¨­å®š</h3>
                    <div class="form-group">
                        <label>å–®é å¯¬åº¦ (åƒç´ )</label>
                        <input type="number" id="pageWidth" value="2480" step="100">
                    </div>
                    <div class="form-group">
                        <label>å–®é é«˜åº¦ (åƒç´ )</label>
                        <input type="number" id="pageHeight" value="3508" step="100">
                    </div>
                </div>

                <div class="section">
                    <h3>4. æ’ç‰ˆå¾®èª¿</h3>
                    <div class="form-group">
                        <label>åœ–ç‰‡ä½”æ¯” <span class="slider-value" id="imgRatioValue">55%</span></label>
                        <input type="range" id="imgRatio" min="40" max="70" value="55">
                    </div>
                    <div class="form-group">
                        <label>æ¨™é¡Œä¸Šæ–¹é–“è· <span class="slider-value" id="titleTopMarginValue">120</span></label>
                        <input type="range" id="titleTopMargin" min="20" max="150" value="120">
                    </div>
                    <div class="form-group">
                        <label>æœˆæ›†å·¦å³é‚Šç•Œ <span class="slider-value" id="calMarginXValue">100</span></label>
                        <input type="range" id="calMarginX" min="50" max="300" value="100">
                    </div>
                    <div class="form-group">
                        <label>æœˆæ›†ä¸‹æ–¹é‚Šç•Œ <span class="slider-value" id="calMarginYValue">80</span></label>
                        <input type="range" id="calMarginY" min="50" max="200" value="80">
                    </div>
                    <div class="form-group">
                        <label>å…©æœˆå·¦å³é–“è· <span class="slider-value" id="monthGapValue">60</span></label>
                        <input type="range" id="monthGap" min="20" max="150" value="60">
                    </div>
                    <div class="form-group">
                        <label>æœˆä»½æ¨™é¡Œèˆ‡æ˜ŸæœŸé–“è· <span class="slider-value" id="titleWeekGapValue">80</span></label>
                        <input type="range" id="titleWeekGap" min="10" max="80" value="80">
                    </div>
                    <div class="form-group">
                        <label>æ˜ŸæœŸèˆ‡æ—¥æœŸé–“è· <span class="slider-value" id="weekDateGapValue">80</span></label>
                        <input type="range" id="weekDateGap" min="20" max="100" value="80">
                    </div>
                </div>

                <div class="section">
                    <h3>5. æœˆä»½æ¨£å¼</h3>
                    <div class="form-group">
                        <label>æœˆä»½é¡¯ç¤º</label>
                        <div class="radio-group">
                            <label><input type="radio" name="monthStyle" value="number" checked> æ•¸å­—</label>
                            <label><input type="radio" name="monthStyle" value="english"> è‹±æ–‡</label>
                            <label><input type="radio" name="monthStyle" value="both"> è‹±æ–‡+æ•¸å­—</label>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="showBorder">
                        <label for="showBorder">é¡¯ç¤ºæœˆä»½æ¡†ç·š</label>
                    </div>
                </div>

                <div class="section">
                    <h3>6. å­—é«”å¤§å°</h3>
                    <div class="form-group">
                        <label>æ¨™é¡Œå¤§å°</label>
                        <input type="number" id="titleSize" value="80" step="5">
                    </div>
                    <div class="form-group">
                        <label>æœˆä»½æ¨™é¡Œå¤§å°</label>
                        <input type="number" id="monthSize" value="55" step="5">
                    </div>
                    <div class="form-group">
                        <label>æ—¥æœŸæ•¸å­—å¤§å°</label>
                        <input type="number" id="dateSize" value="50" step="2">
                    </div>
                    <div class="form-group">
                        <label>è¾²æ›†/ç¯€æ—¥å¤§å°</label>
                        <input type="number" id="lunarSize" value="30" step="2">
                    </div>
                </div>

                <button onclick="generateCalendar()">ç”Ÿæˆé›™æœˆæ›†</button>
            </div>

            <div class="main">
                <div id="output" class="info">
                    <p>ğŸ‘ˆ è«‹ä¸Šå‚³6å¼µåœ–ç‰‡ä¸¦é»æ“Šã€Œç”Ÿæˆé›™æœˆæ›†ã€æŒ‰éˆ•</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const HOLIDAYS_2026 = {
            '1-1': 'å…ƒæ—¦', '2-16': 'é™¤å¤•', '2-17': 'åˆä¸€', '2-18': 'åˆäºŒ',
            '2-19': 'åˆä¸‰', '2-20': 'åˆå››', '2-21': 'åˆäº”', '2-27': 'åˆå',
            '2-28': '228', '4-3': 'åå…­', '4-4': 'å…’ç«¥', '4-5': 'æ¸…æ˜',
            '4-6': 'åä¹', '5-1': 'å‹å‹•', '6-19': 'ç«¯åˆ', '9-25': 'ä¸­ç§‹',
            '10-9': 'å»¿ä¹', '10-10': 'åœ‹æ…¶', '10-25': 'å…‰å¾©', '10-26': 'åä¸ƒ',
            '12-25': 'è¡Œæ†²'
        };

        const SOLAR_TERMS_2026 = {
            '1-5': 'å°å¯’', '1-20': 'å¤§å¯’', '2-4': 'ç«‹æ˜¥', '2-18': 'é›¨æ°´',
            '3-5': 'é©šèŸ„', '3-20': 'æ˜¥åˆ†', '4-4': 'æ¸…æ˜', '4-20': 'ç©€é›¨',
            '5-5': 'ç«‹å¤', '5-21': 'å°æ»¿', '6-5': 'èŠ’ç¨®', '6-21': 'å¤è‡³',
            '7-7': 'å°æš‘', '7-22': 'å¤§æš‘', '8-7': 'ç«‹ç§‹', '8-23': 'è™•æš‘',
            '9-7': 'ç™½éœ²', '9-23': 'ç§‹åˆ†', '10-8': 'å¯’éœ²', '10-23': 'éœœé™',
            '11-7': 'ç«‹å†¬', '11-22': 'å°é›ª', '12-7': 'å¤§é›ª', '12-21': 'å†¬è‡³'
        };

        const MONTH_NAMES_EN = ['', 'January', 'February', 'March', 'April', 'May', 'June',
                                'July', 'August', 'September', 'October', 'November', 'December'];

        document.querySelectorAll('input[type="range"]').forEach(slider => {
            const valueSpan = document.getElementById(slider.id + 'Value');
            slider.addEventListener('input', () => {
                const unit = slider.id === 'imgRatio' ? '%' : '';
                valueSpan.textContent = slider.value + unit;
            });
        });

        function getLunarText(year, month, day) {
            const key = `${month}-${day}`;
            if (SOLAR_TERMS_2026[key]) return SOLAR_TERMS_2026[key];
            
            const lunar = Lunar.fromDate(new Date(year, month - 1, day));
            const lunarDay = lunar.getDay();
            const lunarMonth = lunar.getMonth();
            
            if (lunarMonth === 1 && lunarDay === 1) return 'æ˜¥ç¯€';
            if (lunarMonth === 5 && lunarDay === 5) return 'ç«¯åˆ';
            if (lunarMonth === 8 && lunarDay === 15) return 'ä¸­ç§‹';
            
            if (lunarDay === 1) {
                const monthNames = ['', 'æ­£', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'ä¸ƒ', 'å…«', 'ä¹', 'å', 'å†¬', 'è‡˜'];
                return monthNames[lunarMonth] + 'æœˆ';
            }
            
            const dayNames = ['', 'åˆä¸€', 'åˆäºŒ', 'åˆä¸‰', 'åˆå››', 'åˆäº”', 'åˆå…­', 'åˆä¸ƒ', 'åˆå…«', 'åˆä¹', 'åˆå',
                            'åä¸€', 'åäºŒ', 'åä¸‰', 'åå››', 'åäº”', 'åå…­', 'åä¸ƒ', 'åå…«', 'åä¹', 'äºŒå',
                            'å»¿ä¸€', 'å»¿äºŒ', 'å»¿ä¸‰', 'å»¿å››', 'å»¿äº”', 'å»¿å…­', 'å»¿ä¸ƒ', 'å»¿å…«', 'å»¿ä¹', 'ä¸‰å'];
            return dayNames[lunarDay];
        }

        function getDaysInMonth(year, month) {
            return new Date(year, month, 0).getDate();
        }

        function getFirstDayOfMonth(year, month) {
            return new Date(year, month - 1, 1).getDay();
        }

        function loadImage(file) {
            return new Promise((resolve, reject) => {
                if (!file) {
                    reject(new Error('No file'));
                    return;
                }
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => resolve(img);
                    img.onerror = () => reject(new Error('Image load failed'));
                    img.src = e.target.result;
                };
                reader.onerror = () => reject(new Error('File read failed'));
                reader.readAsDataURL(file);
            });
        }

        function drawMonthCalendar(ctx, month, baseX, baseY, cellW, cellH, params) {
            const { monthSize, dateSize, lunarSize, monthStyle, showBorder, titleWeekGap, weekDateGap } = params;

            if (showBorder) {
                ctx.strokeStyle = 'gray';
                ctx.lineWidth = 2;
                ctx.strokeRect(baseX - 10, baseY - 10, cellW + 20, cellH + 20);
            }

            let monthTitle;
            if (monthStyle === 'english') {
                monthTitle = MONTH_NAMES_EN[month];
            } else if (monthStyle === 'both') {
                monthTitle = `${MONTH_NAMES_EN[month]} ${month}æœˆ`;
            } else {
                monthTitle = `${month}æœˆ`;
            }

            ctx.font = `bold ${monthSize}px "Microsoft JhengHei", sans-serif`;
            ctx.fillStyle = 'black';
            ctx.textAlign = 'center';
            ctx.fillText(monthTitle, baseX + cellW / 2, baseY + monthSize);

            const headerY = baseY + monthSize + titleWeekGap;

            const days = ['Sun æ—¥', 'Mon ä¸€', 'Tue äºŒ', 'Wed ä¸‰', 'Thu å››', 'Fri äº”', 'Sat å…­'];
            const dayW = cellW / 7;
            ctx.font = `${lunarSize}px "Microsoft JhengHei", sans-serif`;

            days.forEach((d, i) => {
                ctx.fillStyle = (i === 0 || i === 6) ? 'red' : 'black';
                ctx.fillText(d, baseX + i * dayW + dayW / 2, headerY);
            });

            const firstDay = getFirstDayOfMonth(2026, month);
            const daysInMonth = getDaysInMonth(2026, month);
            let currentY = headerY + weekDateGap;
            const lineSpacing = (cellH - (headerY - baseY) - weekDateGap) / 6;

            let day = 1;
            for (let week = 0; week < 6 && day <= daysInMonth; week++) {
                for (let i = 0; i < 7; i++) {
                    if (week === 0 && i < firstDay) continue;
                    if (day > daysInMonth) break;

                    const dx = baseX + i * dayW + dayW / 2;
                    const key = `${month}-${day}`;
                    const isWeekend = (i === 0 || i === 6);
                    const isHoliday = HOLIDAYS_2026[key] !== undefined;
                    const isSolarTerm = SOLAR_TERMS_2026[key] !== undefined;

                    ctx.font = `bold ${dateSize}px "Microsoft JhengHei", sans-serif`;
                    ctx.fillStyle = (isWeekend || isHoliday) ? 'red' : 'black';
                    ctx.textAlign = 'center';
                    ctx.fillText(day.toString(), dx, currentY);

                    let lunarText = getLunarText(2026, month, day);
                    if (HOLIDAYS_2026[key]) lunarText = HOLIDAYS_2026[key];

                    ctx.font = `${lunarSize}px "Microsoft JhengHei", sans-serif`;
                    if (isSolarTerm) {
                        ctx.fillStyle = 'green';
                    } else if (isWeekend || isHoliday) {
                        ctx.fillStyle = 'red';
                    } else {
                        ctx.fillStyle = 'gray';
                    }
                    ctx.fillText(lunarText, dx, currentY + dateSize);

                    day++;
                }
                currentY += lineSpacing;
            }
        }

        async function generateCalendar() {
            const output = document.getElementById('output');
            output.innerHTML = '<div class="loading">ğŸ¨ æ­£åœ¨ç¹ªè£½6é é›™æœˆæ›†...</div>';

            try {
                // è¼‰å…¥æ‰€æœ‰åœ–ç‰‡
                const images = [];
                for (let i = 1; i <= 6; i++) {
                    const fileInput = document.getElementById(`img${i}`);
                    if (fileInput.files.length === 0) {
                        alert(`è«‹ä¸Šå‚³ç¬¬ ${i} å¼µåœ–ç‰‡ (${i*2-1}-${i*2}æœˆ)`);
                        output.innerHTML = '<div class="info"><p>ğŸ‘ˆ è«‹ä¸Šå‚³æ‰€æœ‰6å¼µåœ–ç‰‡</p></div>';
                        return;
                    }
                    images.push(await loadImage(fileInput.files[0]));
                }

                // å–å¾—åƒæ•¸
                const pageWidth = parseInt(document.getElementById('pageWidth').value);
                const pageHeight = parseInt(document.getElementById('pageHeight').value);
                const imgRatio = parseInt(document.getElementById('imgRatio').value) / 100;
                const titleTopMargin = parseInt(document.getElementById('titleTopMargin').value);
                const calMarginX = parseInt(document.getElementById('calMarginX').value);
                const calMarginY = parseInt(document.getElementById('calMarginY').value);
                const monthGap = parseInt(document.getElementById('monthGap').value);
                const titleWeekGap = parseInt(document.getElementById('titleWeekGap').value);
                const weekDateGap = parseInt(document.getElementById('weekDateGap').value);
                const titleSize = parseInt(document.getElementById('titleSize').value);
                const monthSize = parseInt(document.getElementById('monthSize').value);
                const dateSize = parseInt(document.getElementById('dateSize').value);
                const lunarSize = parseInt(document.getElementById('lunarSize').value);
                const customTitle = document.getElementById('customTitle').value;
                const monthStyle = document.querySelector('input[name="monthStyle"]:checked').value;
                const showBorder = document.getElementById('showBorder').checked;

                const pages = [];

                // ç”Ÿæˆ6é 
                for (let pageIdx = 0; pageIdx < 6; pageIdx++) {
                    const canvas = document.createElement('canvas');
                    canvas.width = pageWidth;
                    canvas.height = pageHeight;
                    const ctx = canvas.getContext('2d');

                    ctx.fillStyle = 'white';
                    ctx.fillRect(0, 0, pageWidth, pageHeight);

                    // ç¹ªè£½åœ–ç‰‡
                    const img = images[pageIdx];
                    const imgHeight = pageHeight * imgRatio;
                    const ratio = pageWidth / img.width;
                    const newH = img.height * ratio;

                    if (newH > imgHeight) {
                        ctx.drawImage(img, 0, 0, pageWidth, imgHeight);
                    } else {
                        ctx.drawImage(img, 0, 0, pageWidth, newH);
                    }

                    // ç¹ªè£½æ¨™é¡Œï¼ˆåªåœ¨ç¬¬ä¸€é é¡¯ç¤ºï¼‰
                    if (pageIdx === 0) {
                        ctx.fillStyle = 'black';
                        ctx.font = `bold ${titleSize}px "Microsoft JhengHei", sans-serif`;
                        ctx.textAlign = 'center';
                        const titleY = imgHeight + titleTopMargin;
                        ctx.fillText(customTitle, pageWidth / 2, titleY);
                    }

                    // è¨ˆç®—æœˆæ›†å€åŸŸ
                    const calStartY = imgHeight + (pageIdx === 0 ? titleTopMargin + titleSize + 30 : titleTopMargin);
                    const calAreaH = pageHeight - calStartY - calMarginY;
                    const calAreaW = pageWidth - (2 * calMarginX);

                    // å…©å€‹æœˆä»½ä¸¦æ’
                    const cellW = (calAreaW - monthGap) / 2;
                    const cellH = calAreaH;

                    const month1 = pageIdx * 2 + 1;
                    const month2 = pageIdx * 2 + 2;

                    const params = { monthSize, dateSize, lunarSize, monthStyle, showBorder, titleWeekGap, weekDateGap };

                    // ç¹ªè£½å·¦é‚Šæœˆä»½
                    drawMonthCalendar(ctx, month1, calMarginX, calStartY, cellW, cellH, params);

                    // ç¹ªè£½å³é‚Šæœˆä»½
                    drawMonthCalendar(ctx, month2, calMarginX + cellW + monthGap, calStartY, cellW, cellH, params);

                    // éš±è—æ–‡å­—ï¼ˆåªåœ¨æœ€å¾Œä¸€é ï¼‰
                    if (pageIdx === 5) {
                        ctx.font = `${lunarSize - 4}px "Microsoft JhengHei", sans-serif`;
                        ctx.fillStyle = 'rgba(200, 200, 200, 0.3)';
                        ctx.textAlign = 'right';
                        ctx.fillText('Sep 9 è¾²æ›†ä¹æœˆä¹ç”Ÿæ—¥', pageWidth - 30, pageHeight - 30);
                    }

                    pages.push(canvas.toDataURL('image/jpeg', 0.95));
                }

                // é¡¯ç¤ºæ‰€æœ‰é é¢
                let html = '<div style="display: flex; flex-direction: column; gap: 20px; align-items: center;">';
                pages.forEach((img, idx) => {
                    const months = `${idx*2+1}-${idx*2+2}æœˆ`;
                    html += `
                        <div style="width: 100%;">
                            <h3 style="text-align: center; color: #667eea; margin-bottom: 10px;">ç¬¬${idx+1}é  (${months})</h3>
                            <img src="${img}" style="max-width: 100%; border: 2px solid #e0e0e0; border-radius: 10px;">
                            <button class="download-btn" onclick="downloadPage(${idx})">ğŸ“¥ ä¸‹è¼‰ç¬¬${idx+1}é </button>
                        </div>
                    `;
                });
                html += '</div>';

                output.innerHTML = html;
                window.generatedPages = pages;

            } catch (error) {
                alert('ç”Ÿæˆå¤±æ•—: ' + error.message);
                output.innerHTML = '<div class="info"><p>âŒ ç”Ÿæˆå¤±æ•—ï¼Œè«‹æª¢æŸ¥åœ–ç‰‡æ˜¯å¦æ­£ç¢º</p></div>';
            }
        }

        function downloadPage(pageIdx) {
            const link = document.createElement('a');
            const months = `${pageIdx*2+1}-${pageIdx*2+2}`;
            link.download = `2026_Calendar_${months}æœˆ.jpg`;
            link.href = window.generatedPages[pageIdx];
            link.click();
        }
    </script>
</body>
</html>