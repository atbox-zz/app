<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸª åœ°çƒ Online | æŠ•èƒä¼ºæœå™¨ç”³è«‹</title>
    <!-- å¼•å…¥ Tailwind CSS å¿«é€Ÿåˆ‡ç‰ˆ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥å­—é«”å„ªåŒ– -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: #0f172a; 
            color: #e2e8f0; 
            -webkit-tap-highlight-color: transparent;
        }
        
        /* éš±è—å·è»¸ä½†ä¿ç•™åŠŸèƒ½ */
        .card-scroll { 
            -ms-overflow-style: none; 
            scrollbar-width: none; 
        }
        .card-scroll::-webkit-scrollbar { 
            display: none; 
        }
        
        /* é¸é …é¸ä¸­æ¨£å¼ */
        .select-box:checked + div { 
            border-color: #38bdf8; 
            background-color: #1e293b; 
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.3); 
            transform: translateY(-2px);
        }
        
        /* å½ˆçª—å‹•ç•« */
        .pop-in { 
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; 
        }
        @keyframes popIn { 
            from { opacity: 0; transform: scale(0.8); } 
            to { opacity: 1; transform: scale(1); } 
        }

        /* éœ“è™¹æ–‡å­—ç‰¹æ•ˆ */
        .neon-text {
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }
    </style>
</head>
<body class="min-h-screen pb-20 selection:bg-purple-500 selection:text-white">

    <!-- æ¨™é¡Œå€ -->
    <header class="text-center py-10 px-4">
        <div class="inline-block p-2 bg-indigo-900/50 border border-indigo-500/30 rounded-full mb-4 text-xs font-bold tracking-widest text-indigo-200">BETA 1.0</div>
        <h1 class="text-4xl md:text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 mb-2 neon-text">
            ğŸª æŠ•èƒæ¨¡æ“¬å™¨
        </h1>
        <p class="text-slate-400 font-bold tracking-wide">REBIRTH GACHA SYSTEM</p>
        <p class="mt-4 text-sm md:text-base text-slate-300 max-w-lg mx-auto leading-relaxed">
            å¤¢æƒ³å¾ˆè±æ»¿ï¼Œæ©Ÿç‡å¾ˆéª¨æ„Ÿã€‚<br>
            è«‹èª å¯¦å¡«å¯«å¿—é¡˜ï¼Œç³»çµ±å°‡æ ¹æ“šã€Œæ¥­åŠ›ã€èˆ‡ã€Œå¤§æ•¸æ“šã€ç‚ºæ‚¨å®‰æ’ä¾†ä¸–ã€‚
        </p>
    </header>

    <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šä¼ºæœå™¨å°è¦½ (æ°´å¹³æ»‘å‹•) -->
    <section class="max-w-4xl mx-auto mb-12 px-4">
        <h2 class="text-xl font-bold mb-4 flex items-center text-slate-100">
            <span class="mr-2 text-2xl">ğŸŒ</span> ç•¶å‰ä¼ºæœå™¨ç†±é–€æ¦œ
            <span class="ml-auto text-xs font-normal text-slate-500 bg-slate-800 px-2 py-1 rounded-full">â† å·¦å³æ»‘å‹• â†’</span>
        </h2>
        
        <div class="flex overflow-x-auto gap-4 card-scroll pb-4 snap-x">
            <!-- SSR å¡ç‰‡ -->
            <div class="flex-none w-72 bg-slate-800 rounded-xl p-5 border border-yellow-500/30 shadow-lg relative overflow-hidden snap-center group hover:border-yellow-500/60 transition">
                <div class="absolute top-0 right-0 bg-yellow-500 text-black text-xs font-bold px-3 py-1 rounded-bl-lg z-10">SSR å¤¢å¹»å€</div>
                <div class="text-4xl mb-3 group-hover:scale-110 transition duration-300">ğŸ‡«ğŸ‡® ğŸ‡¨ğŸ‡­ ğŸ‡³ğŸ‡´</div>
                <h3 class="font-bold text-lg text-yellow-100">åŒ—æ­èˆ‡å¿«æ¨‚å¤©å ‚</h3>
                <p class="text-xs text-slate-400 mt-1 mb-3">èŠ¬è˜­ã€ç‘å£«ã€æŒªå¨</p>
                <ul class="text-sm space-y-1 text-slate-300">
                    <li>âœ… å¾æ–ç±ƒé¤Šåˆ°å¢³å¢“</li>
                    <li>âœ… é¢¨æ™¯ç¾å¦‚ç•«</li>
                    <li>âŒ ç¨…é‡‘æ¥µé«˜ã€å†¬å¤©æ†‚é¬±</li>
                </ul>
                <div class="mt-4 text-xs text-yellow-500 font-mono bg-yellow-500/10 p-2 rounded">ä¸­çç‡ï¼š&lt; 0.5%</div>
            </div>

            <!-- SR å¡ç‰‡ -->
            <div class="flex-none w-72 bg-slate-800 rounded-xl p-5 border border-purple-500/30 shadow-lg relative snap-center group hover:border-purple-500/60 transition">
                <div class="absolute top-0 right-0 bg-purple-600 text-white text-xs font-bold px-3 py-1 rounded-bl-lg z-10">SR èª²é‡‘å€</div>
                <div class="text-4xl mb-3 group-hover:scale-110 transition duration-300">ğŸ‡ºğŸ‡¸ ğŸ‡©ğŸ‡ª ğŸ‡¬ğŸ‡§</div>
                <h3 class="font-bold text-lg text-purple-100">æ­ç¾åˆ—å¼·</h3>
                <p class="text-xs text-slate-400 mt-1 mb-3">ç¾åœ‹ã€å¾·åœ‹ã€è‹±åœ‹</p>
                <ul class="text-sm space-y-1 text-slate-300">
                    <li>âœ… è–ªè³‡ä¸Šé™æ¥µé«˜</li>
                    <li>âœ… æ–‡åŒ–èˆ‡ç§‘æŠ€ä¸­å¿ƒ</li>
                    <li>âŒ æ²»å®‰/é†«ç™‚/é£Ÿç‰© éš¨æ©Ÿæœ‰é›·</li>
                </ul>
                <div class="mt-4 text-xs text-purple-400 font-mono bg-purple-500/10 p-2 rounded">ä¸­çç‡ï¼šç´„ 8%</div>
            </div>

            <!-- R+ å¡ç‰‡ -->
            <div class="flex-none w-72 bg-slate-800 rounded-xl p-5 border border-green-500/30 shadow-lg relative snap-center group hover:border-green-500/60 transition">
                <div class="absolute top-0 right-0 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-bl-lg z-10">R+ éš±è—ç‰ˆ</div>
                <div class="text-4xl mb-3 group-hover:scale-110 transition duration-300">ğŸ‡¹ğŸ‡¼ ğŸ‡¯ğŸ‡µ ğŸ‡¹ğŸ‡­</div>
                <h3 class="font-bold text-lg text-green-100">äºæ´²ä¾¿åˆ©å€</h3>
                <p class="text-xs text-slate-400 mt-1 mb-3">å°ç£ã€æ—¥æœ¬ã€æ³°åœ‹</p>
                <ul class="text-sm space-y-1 text-slate-300">
                    <li>âœ… æ±è¥¿è¶…å¥½åƒ</li>
                    <li>âœ… ä¾¿åˆ©å•†åº—æ˜¯ç¥</li>
                    <li>âŒ ç¤¾æœƒå£“åŠ›å¤§ã€éå‹</li>
                </ul>
                <div class="mt-4 text-xs text-green-400 font-mono bg-green-500/10 p-2 rounded">ä¸­çç‡ï¼šç´„ 3%</div>
            </div>

            <!-- N å¡ç‰‡ -->
            <div class="flex-none w-72 bg-slate-800 rounded-xl p-5 border border-slate-600 shadow-lg relative snap-center group hover:border-slate-500 transition">
                <div class="absolute top-0 right-0 bg-slate-600 text-white text-xs font-bold px-3 py-1 rounded-bl-lg z-10">N å¸¸é§å€</div>
                <div class="text-4xl mb-3 group-hover:scale-110 transition duration-300">ğŸ‡®ğŸ‡³ ğŸ‡¨ğŸ‡³ ğŸ‡³ğŸ‡¬</div>
                <h3 class="font-bold text-lg text-slate-200">äººå£å¤§åœ‹å€</h3>
                <p class="text-xs text-slate-400 mt-1 mb-3">å°åº¦ã€ä¸­åœ‹ã€å¥ˆåŠåˆ©äº</p>
                <ul class="text-sm space-y-1 text-slate-300">
                    <li>âœ… ç†±é¬§ï¼ˆæ“ ï¼‰ã€é¦™æ–™ï¼ˆè¾£ï¼‰</li>
                    <li>âœ… é–‹å±€é›£åº¦ Hard</li>
                    <li>âŒ ç«¶çˆ­æ¥µåº¦æ¿€çƒˆ</li>
                </ul>
                <div class="mt-4 text-xs text-slate-400 font-mono bg-slate-700/50 p-2 rounded">ä¸­çç‡ï¼š> 50%</div>
            </div>
        </div>

        <div class="mt-4 flex items-start gap-3 bg-slate-800/50 p-4 rounded-lg border border-slate-700">
            <input type="checkbox" id="agreement" class="mt-1 w-5 h-5 accent-blue-500 cursor-pointer">
            <label for="agreement" class="text-sm text-slate-300 cursor-pointer leading-snug">
                æˆ‘å·²é–±è®€ä¸¦çŸ¥æ‚‰ <span class="text-yellow-400 font-bold">SSR åœ‹å®¶åé¡æ¥µå°‘</span>ï¼Œè‹¥æŠ•èƒçµæœä¸ç†æƒ³ï¼Œæœ¬äººæ‰¿è«¾ä¸å¾—å‘é–»ç¾…ç‹æˆ–ç³»çµ±ç®¡ç†å“¡æŠ•è¨´ã€‚
            </label>
        </div>
    </section>

    <!-- ç¬¬äºŒéƒ¨åˆ†ï¼šå¿—é¡˜é¸å–® -->
    <section class="max-w-2xl mx-auto px-4" id="quiz-section">
        <h2 class="text-2xl font-bold mb-8 text-center border-b border-slate-700 pb-4 text-slate-100">ğŸ“ éˆé­‚å¿—é¡˜å–®</h2>

        <!-- Q1 -->
        <div class="mb-10">
            <p class="text-lg font-bold mb-4 text-blue-300 flex items-center"><span class="bg-blue-900/50 text-blue-300 px-2 rounded mr-2 text-sm">Q1</span> ä¸‹è¼©å­ä½ æƒ³ç©ä»€éº¼æ¨¡å¼ï¼Ÿ</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <label class="cursor-pointer relative group">
                    <input type="radio" name="q1" value="easy" class="select-box absolute opacity-0 w-full h-full cursor-pointer">
                    <div class="border border-slate-600 rounded-xl p-5 transition-all group-hover:bg-slate-800 bg-slate-800/40">
                        <div class="font-bold text-lg mb-1">ğŸ‘¶ ç°¡å–®æ¨¡å¼ (Easy)</div>
                        <div class="text-xs text-slate-400">ç¦åˆ©å¥½ã€ä¸åŠ ç­ã€åœ‹å®¶é¤Šæˆ‘ã€‚</div>
                    </div>
                </label>
                <label class="cursor-pointer relative group">
                    <input type="radio" name="q1" value="hard" class="select-box absolute opacity-0 w-full h-full cursor-pointer">
                    <div class="border border-slate-600 rounded-xl p-5 transition-all group-hover:bg-slate-800 bg-slate-800/40">
                        <div class="font-bold text-lg mb-1">ğŸº å›°é›£æ¨¡å¼ (Hard)</div>
                        <div class="text-xs text-slate-400">ç«¶çˆ­æ¿€çƒˆã€æ©Ÿæœƒå¤šã€æˆ‘è¦è³ºå¤§éŒ¢ã€‚</div>
                    </div>
                </label>
            </div>
        </div>

        <!-- Q2 -->
        <div class="mb-10">
            <p class="text-lg font-bold mb-4 text-blue-300 flex items-center"><span class="bg-blue-900/50 text-blue-300 px-2 rounded mr-2 text-sm">Q2</span> ä½ å°äººé¡çš„å®¹å¿åº¦ï¼Ÿ</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <label class="cursor-pointer relative group">
                    <input type="radio" name="q2" value="introvert" class="select-box absolute opacity-0 w-full h-full cursor-pointer">
                    <div class="border border-slate-600 rounded-xl p-5 transition-all group-hover:bg-slate-800 bg-slate-800/40">
                        <div class="font-bold text-lg mb-1">ğŸ¤ ç¤¾æ (Iäºº)</div>
                        <div class="text-xs text-slate-400">åˆ¥è·Ÿæˆ‘èªªè©±ï¼Œä¿æŒç¤¾äº¤è·é›¢ã€‚</div>
                    </div>
                </label>
                <label class="cursor-pointer relative group">
                    <input type="radio" name="q2" value="extrovert" class="select-box absolute opacity-0 w-full h-full cursor-pointer">
                    <div class="border border-slate-600 rounded-xl p-5 transition-all group-hover:bg-slate-800 bg-slate-800/40">
                        <div class="font-bold text-lg mb-1">ğŸ¥³ ç¤¾ç‰› (Eäºº)</div>
                        <div class="text-xs text-slate-400">ç†±é¬§æ‰åƒå®¶ï¼Œéš¨æ™‚è·¯é‚Šè·³èˆã€‚</div>
                    </div>
                </label>
            </div>
        </div>

        <!-- Q3 -->
        <div class="mb-10">
            <p class="text-lg font-bold mb-4 text-blue-300 flex items-center"><span class="bg-blue-900/50 text-blue-300 px-2 rounded mr-2 text-sm">Q3</span> ä½ çš„èƒƒèƒ½æ¥å—ä»€éº¼ï¼Ÿ</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <label class="cursor-pointer relative group">
                    <input type="radio" name="q3" value="tasty" class="select-box absolute opacity-0 w-full h-full cursor-pointer">
                    <div class="border border-slate-600 rounded-xl p-5 transition-all group-hover:bg-slate-800 bg-slate-800/40">
                        <div class="font-bold text-lg mb-1">ğŸœ ç¾é£Ÿçµäºº</div>
                        <div class="text-xs text-slate-400">é›£åƒçš„æ±è¥¿æ˜¯çŠ¯ç½ªï¼Œæˆ‘è¦å¥½åƒï¼</div>
                    </div>
                </label>
                <label class="cursor-pointer relative group">
                    <input type="radio" name="q3" value="survive" class="select-box absolute opacity-0 w-full h-full cursor-pointer">
                    <div class="border border-slate-600 rounded-xl p-5 transition-all group-hover:bg-slate-800 bg-slate-800/40">
                        <div class="font-bold text-lg mb-1">ğŸ¥” ç”Ÿå‘½ç¶­æŒ</div>
                        <div class="text-xs text-slate-400">é¦¬éˆ´è–¯ã€ç‚¸é­šã€å†·éºµåŒ…éƒ½èƒ½æ´»ã€‚</div>
                    </div>
                </label>
            </div>
        </div>

        <!-- Q4 -->
        <div class="mb-12">
            <p class="text-lg font-bold mb-4 text-blue-300 flex items-center"><span class="bg-blue-900/50 text-blue-300 px-2 rounded mr-2 text-sm">Q4</span> æ°£å€™åå¥½ï¼Ÿ</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <label class="cursor-pointer relative group">
                    <input type="radio" name="q4" value="cold" class="select-box absolute opacity-0 w-full h-full cursor-pointer">
                    <div class="border border-slate-600 rounded-xl p-5 transition-all group-hover:bg-slate-800 bg-slate-800/40">
                        <div class="font-bold text-lg mb-1">â„ï¸ æ€•ç†±</div>
                        <div class="text-xs text-slate-400">çµ¦æˆ‘é›ªã€æš–æ°£å’Œæ°¸å¤œã€‚</div>
                    </div>
                </label>
                <label class="cursor-pointer relative group">
                    <input type="radio" name="q4" value="hot" class="select-box absolute opacity-0 w-full h-full cursor-pointer">
                    <div class="border border-slate-600 rounded-xl p-5 transition-all group-hover:bg-slate-800 bg-slate-800/40">
                        <div class="font-bold text-lg mb-1">â˜€ï¸ æ€•å†·</div>
                        <div class="text-xs text-slate-400">çµ¦æˆ‘é™½å…‰ã€æ²™ç˜å’Œé¢±é¢¨ã€‚</div>
                    </div>
                </label>
            </div>
        </div>

        <!-- æäº¤æŒ‰éˆ• -->
        <button onclick="startGacha()" class="w-full bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white font-black text-2xl py-6 rounded-2xl shadow-[0_0_20px_rgba(79,70,229,0.5)] transform transition active:scale-95 mb-4 border border-white/10 relative overflow-hidden group">
            <span class="relative z-10">ğŸ”´ æäº¤ç”³è«‹ï¼Œé–‹å§‹æŠ•èƒ</span>
            <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition duration-300"></div>
        </button>
        <p class="text-center text-xs text-slate-500">*æŒ‰ä¸‹æŒ‰éˆ•å³ä»£è¡¨æ”¾æ£„æœ¬ä¸–æ‰€æœ‰è¨˜æ†¶</p>
    </section>

    <!-- çµæœå½ˆçª— (é è¨­éš±è—) -->
    <div id="result-modal" class="fixed inset-0 bg-black/95 z-50 hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="max-w-md w-full bg-slate-900 border border-slate-700 rounded-2xl p-6 relative pop-in shadow-2xl">
            <!-- é—œé–‰æŒ‰éˆ• -->
            <button onclick="closeModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white text-xl">âœ•</button>

            <!-- Loading å‹•ç•« -->
            <div id="loading-view" class="text-center py-12">
                <div class="text-6xl animate-spin mb-6 inline-block">ğŸŒ€</div>
                <h3 class="text-2xl font-bold mb-3 text-white">éˆé­‚å‚³è¼¸ä¸­...</h3>
                <p id="loading-text" class="text-slate-400 text-sm animate-pulse">æ­£åœ¨è³„è³‚é–»ç¾…ç‹...</p>
            </div>

            <!-- çµæœå…§å®¹ -->
            <div id="result-view" class="hidden text-center">
                <!-- å¾½ç«  -->
                <div id="result-badge" class="inline-block px-4 py-1 bg-red-600 text-white font-black tracking-widest rounded shadow-lg text-sm mb-5 transform -rotate-2">SSR</div>
                
                <h2 class="text-3xl font-black mb-1 text-white">æŠ•èƒçµæœé€šçŸ¥æ›¸</h2>
                <div class="text-xs text-slate-500 mb-6">CERTIFICATE OF REBIRTH</div>

                <!-- çµæœå¡ç‰‡ -->
                <div class="p-5 bg-slate-800 rounded-xl border border-slate-600 relative overflow-hidden">
                    <!-- ç†æƒ³çµæœå°å­— -->
                    <div class="flex justify-between items-center mb-4 pb-3 border-b border-slate-700/50">
                        <span class="text-xs text-slate-400">ç†æƒ³å¿—é¡˜ï¼š</span>
                        <span id="ideal-match" class="text-blue-400 font-bold text-xs">èŠ¬è˜­ (100%)</span>
                    </div>
                    
                    <!-- å¯¦éš›çµæœå¤§å­— -->
                    <div class="py-2">
                        <p class="text-xs text-slate-400 mb-2 uppercase tracking-widest">Destination</p>
                        <div id="real-country-flag" class="text-7xl mb-3 drop-shadow-md transform hover:scale-110 transition cursor-default">ğŸ‡®ğŸ‡³</div>
                        <h3 id="real-country-name" class="text-3xl font-black text-white mb-1">å°åº¦ (India)</h3>
                        <p id="real-chance" class="text-xs font-mono text-slate-500">äººå£æ©Ÿç‡ä½”æ¯”ï¼š17.7%</p>
                    </div>
                </div>

                <!-- è©•èª -->
                <div class="mt-6 mb-8 relative">
                    <span class="absolute top-0 left-0 text-4xl text-slate-700 -translate-x-2 -translate-y-2">"</span>
                    <p id="result-comment" class="text-sm text-slate-300 italic px-6 leading-relaxed">
                        é›–ç„¶é€™è£¡æ²’æœ‰æ¥µå…‰ï¼Œä½†é€™è£¡æœ‰æœ€ç†±é¬§çš„ç¤¾äº¤ç”Ÿæ´»å’Œé¦™æ–™ï¼
                    </p>
                    <span class="absolute bottom-0 right-0 text-4xl text-slate-700 translate-x-2 translate-y-2">"</span>
                </div>

                <!-- é‡æŠ½æŒ‰éˆ• -->
                <button onclick="location.reload()" class="w-full bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 rounded-xl transition border border-slate-600 hover:border-slate-500 flex items-center justify-center gap-2">
                    <span>ğŸ”„</span> ä¸æœï¼å–å­Ÿå©†æ¹¯é‡æŠ½
                </button>
            </div>
        </div>
    </div>

    <!-- é‚è¼¯è…³æœ¬ -->
    <script>
        // 1. è³‡æ–™åº«ï¼šåœ‹å®¶å±¬æ€§èˆ‡äººå£æ¬Šé‡ 
        // ticket = äººå£æ¬Šé‡ (ä»¥ç™¾è¬ç‚ºå–®ä½ï¼Œæ¦‚ç•¥å€¼)ï¼Œæ•¸å­—è¶Šå¤§è¶Šå®¹æ˜“æŠ½ä¸­
        const countries = [
            // SSR (æ¥µé›£æŠ½ - æ­æ´²/é«˜ç¦åˆ©)
            { id: 'fin', name: 'èŠ¬è˜­', flag: 'ğŸ‡«ğŸ‡®', tags: ['easy', 'introvert', 'cold', 'survive'], ticket: 5, rank: 'SSR', comment: "æ­å–œï¼ä½ æ“Šæ•—äº†å…¨çƒ 99.9% çš„éˆé­‚ï¼Œæ­¡è¿ä¾†åˆ°ç¤¾æå¤©å ‚ã€‚" },
            { id: 'che', name: 'ç‘å£«', flag: 'ğŸ‡¨ğŸ‡­', tags: ['easy', 'introvert', 'cold', 'survive', 'tasty'], ticket: 8, rank: 'SSR', comment: "ä¸Šè¼©å­æ‹¯æ•‘äº†éŠ€æ²³ç³»å—ï¼Ÿæº–å‚™å¥½äº«å—å¥½å±±å¥½æ°´å¥½æœ‰éŒ¢çš„ç”Ÿæ´»ã€‚" },
            { id: 'isl', name: 'å†°å³¶', flag: 'ğŸ‡®ğŸ‡¸', tags: ['easy', 'introvert', 'cold', 'survive'], ticket: 1, rank: 'SSR', comment: "é›–ç„¶æ²’æœ‰èšŠå­å¾ˆæ£’ï¼Œä½†å°å¿ƒåˆ¥åœ¨æ­¤å­¤ç¨çµ‚è€ã€‚" },
            { id: 'nor', name: 'æŒªå¨', flag: 'ğŸ‡³ğŸ‡´', tags: ['easy', 'introvert', 'cold', 'survive'], ticket: 5, rank: 'SSR', comment: "é€™å¤§æ¦‚æ˜¯åœ°çƒä¸Šæœ€æ¥è¿‘å¤©å ‚çš„åœ°æ–¹ï¼Œé™¤äº†ç‰©åƒ¹ä¹‹å¤–ã€‚" },

            // SR (ä¸éŒ¯/ç‰¹è‰² - å·²é–‹ç™¼/æ–‡åŒ–å¼·åœ‹)
            { id: 'usa', name: 'ç¾åœ‹', flag: 'ğŸ‡ºğŸ‡¸', tags: ['hard', 'extrovert', 'survive', 'hot', 'cold'], ticket: 330, rank: 'SR', comment: "å……æ»¿æ©Ÿæœƒçš„åœŸåœ°ï¼è¨˜å¾—è²·é†«ç™‚ä¿éšªï¼Œé€™å¾ˆé‡è¦ã€‚" },
            { id: 'jpn', name: 'æ—¥æœ¬', flag: 'ğŸ‡¯ğŸ‡µ', tags: ['hard', 'introvert', 'tasty', 'cold'], ticket: 125, rank: 'SR', comment: "é£Ÿç‰©å¥½åƒã€è¡—é“ä¹¾æ·¨ï¼Œä½†è¨˜å¾—ç·´ç¿’ã€Œè®€ç©ºæ°£ã€ã€‚" },
            { id: 'twn', name: 'å°ç£', flag: 'ğŸ‡¹ğŸ‡¼', tags: ['hard', 'extrovert', 'tasty', 'hot'], ticket: 23, rank: 'SR', comment: "éš±è—ç‰ˆå½©è›‹ï¼é›–ç„¶äº¤é€šåƒå¤§é€ƒæ®ºï¼Œä½†çå¥¶åŠç³–å°‘å†°æ˜¯çœŸç†ã€‚" },
            { id: 'deu', name: 'å¾·åœ‹', flag: 'ğŸ‡©ğŸ‡ª', tags: ['easy', 'introvert', 'survive', 'cold'], ticket: 83, rank: 'SR', comment: "æ•ˆç‡èˆ‡ç§©åºçš„åœ‹åº¦ï¼Œé€™è£¡çš„éºµåŒ…å¯èƒ½æœƒå’¬æ–·ä½ çš„ç‰™é½’ã€‚" },
            { id: 'gbr', name: 'è‹±åœ‹', flag: 'ğŸ‡¬ğŸ‡§', tags: ['easy', 'introvert', 'survive', 'cold'], ticket: 67, rank: 'SR', comment: "å¤©æ°£é™°æ²‰ï¼Œé£Ÿç‰©...å—¯ï¼Œè‡³å°‘ä½ å¯ä»¥å¤©å¤©å–ä¸‹åˆèŒ¶ã€‚" },
            { id: 'can', name: 'åŠ æ‹¿å¤§', flag: 'ğŸ‡¨ğŸ‡¦', tags: ['easy', 'introvert', 'survive', 'cold'], ticket: 38, rank: 'SR', comment: "å¥½å±±å¥½æ°´å¥½ç„¡èŠï¼Œé‚„æœ‰å¾ˆæœ‰ç¦®è²Œçš„ç†Šã€‚" },
            
            // R (æ™®é€š/ç‰¹å®šé¢¨æ ¼ - ç™¼å±•ä¸­/ç†±æƒ…)
            { id: 'tha', name: 'æ³°åœ‹', flag: 'ğŸ‡¹ğŸ‡­', tags: ['hard', 'extrovert', 'tasty', 'hot'], ticket: 70, rank: 'R', comment: "è–©ç“¦è¿ªå¡ï¼å¤©å¤©éƒ½èƒ½äº«å—æŒ‰æ‘©å’Œè·¯é‚Šæ”¤ç¾é£Ÿï¼Œç†±æƒ…æ»¿åˆ†ã€‚" },
            { id: 'bra', name: 'å·´è¥¿', flag: 'ğŸ‡§ğŸ‡·', tags: ['hard', 'extrovert', 'tasty', 'hot'], ticket: 214, rank: 'R', comment: "ç†±æƒ…å¥”æ”¾ï¼è¶³çƒã€æ£®å·´ã€å˜‰å¹´è¯ã€‚é€™è£¡æ²’æœ‰ã€Œç¤¾æã€é€™å…©å€‹å­—ã€‚" },
            { id: 'rus', name: 'ä¿„ç¾…æ–¯', flag: 'ğŸ‡·ğŸ‡º', tags: ['easy', 'introvert', 'survive', 'cold'], ticket: 144, rank: 'R', comment: "æˆ°é¬¥æ°‘æ—æ­¡è¿ä½ ã€‚é€™è£¡å†¬å¤©å¾ˆé•·ï¼Œä¼ç‰¹åŠ å¾ˆçƒˆã€‚" },
            { id: 'vnm', name: 'è¶Šå—', flag: 'ğŸ‡»ğŸ‡³', tags: ['hard', 'extrovert', 'tasty', 'hot'], ticket: 97, rank: 'R', comment: "æ©Ÿè»Šæµ·èˆ‡æ²³ç²‰çš„åœ‹åº¦ï¼Œé€™è£¡çš„æ´»åŠ›æœƒè®“ä½ å¤§åƒä¸€é©šã€‚" },

            // N (äººå£å¤§åœ‹ - çµ•å°ä¸»åŠ›)
            { id: 'ind', name: 'å°åº¦', flag: 'ğŸ‡®ğŸ‡³', tags: ['hard', 'extrovert', 'tasty', 'hot'], ticket: 1400, rank: 'N', comment: "åˆ¥æ“”å¿ƒï¼Œé€™è£¡æ˜¯ä¸–ç•Œçš„ä¸­å¿ƒï¼ˆäººå£æ„ç¾©ä¸Šï¼‰ã€‚ç·´å¥½ç‘œä¼½ï¼Œæº–å‚™æ“ ç«è»Šï¼" },
            { id: 'chn', name: 'ä¸­åœ‹', flag: 'ğŸ‡¨ğŸ‡³', tags: ['hard', 'extrovert', 'tasty', 'cold', 'hot'], ticket: 1410, rank: 'N', comment: "Hard æ¨¡å¼ä¸­çš„éœ¸ä¸»ã€‚ç«¶çˆ­æ¿€çƒˆï¼Œä½†å¤–é€é€Ÿåº¦ä¸–ç•Œç¬¬ä¸€ã€‚" },
            { id: 'nga', name: 'å¥ˆåŠåˆ©äº', flag: 'ğŸ‡³ğŸ‡¬', tags: ['hard', 'extrovert', 'survive', 'hot'], ticket: 210, rank: 'N', comment: "æ­¡è¿ä¾†åˆ°éæ´²å·¨äººï¼é€™è£¡å……æ»¿æ´»åŠ›ï¼Œè€Œä¸”...çœŸçš„å¾ˆç†±ã€‚" },
            { id: 'idn', name: 'å°å°¼', flag: 'ğŸ‡®ğŸ‡©', tags: ['hard', 'extrovert', 'tasty', 'hot'], ticket: 270, rank: 'N', comment: "åƒå³¶ä¹‹åœ‹ï¼æ¯å¤©éƒ½åœ¨ç†±å¸¶é›¨æ—èˆ‡å¡è»Šä¸­åº¦éã€‚" },
            { id: 'pak', name: 'å·´åŸºæ–¯å¦', flag: 'ğŸ‡µğŸ‡°', tags: ['hard', 'extrovert', 'tasty', 'hot'], ticket: 230, rank: 'N', comment: "é€™è£¡çš„æ¿çƒæ˜¯ä¿¡ä»°ï¼Œé£Ÿç‰©å¾ˆè¾£ï¼Œå¤§å®¶åº­å¾ˆç†±é¬§ã€‚" },
            { id: 'bgd', name: 'å­ŸåŠ æ‹‰', flag: 'ğŸ‡§ğŸ‡©', tags: ['hard', 'extrovert', 'survive', 'hot'], ticket: 170, rank: 'N', comment: "ä¸–ç•Œä¸Šäººå£å¯†åº¦æœ€é«˜çš„åœ°æ–¹ä¹‹ä¸€ï¼Œæ°¸é ä¸ç¼ºäººé™ªä½ èŠå¤©ã€‚" }
        ];

        // 2. éš¨æ©Ÿ Loading æ–‡å­—
        const loadingTexts = [
            "æ­£åœ¨è³„è³‚é–»ç¾…ç‹...",
            "æ­£åœ¨è¨ˆç®—æ‚¨çš„é™°å¾·å€¼...",
            "å˜—è©¦æ“ é€²ç‘å…¸çš„ç”¢æˆ¿...å¤±æ•—...",
            "æ­£åœ¨æƒæå…¨çƒç©ºç¼ºåé¡...",
            "èˆ‡å‘½é‹å¥³ç¥æ“²éª°å­ä¸­...",
            "ç³»çµ±ç¹å¿™ï¼Œæ­£åœ¨æ’éšŠæŠ•èƒ..."
        ];

        function startGacha() {
            // æª¢æŸ¥å”è­°
            const agreement = document.getElementById('agreement');
            if (!agreement.checked) {
                alert("âš ï¸ è«‹å…ˆå‹¾é¸åŒæ„æŠ•èƒå”è­°ï¼Œç¢ºèªæ‚¨å·²çŸ¥æ‚‰ SSR åœ‹å®¶å¾ˆé›£ä¸­ã€‚");
                // æ²å‹•åˆ°å”è­°è™•
                agreement.scrollIntoView({behavior: "smooth", block: "center"});
                return;
            }

            // å–å¾—ä½¿ç”¨è€…é¸æ“‡
            const q1 = document.querySelector('input[name="q1"]:checked');
            const q2 = document.querySelector('input[name="q2"]:checked');
            const q3 = document.querySelector('input[name="q3"]:checked');
            const q4 = document.querySelector('input[name="q4"]:checked');

            // æª¢æŸ¥æ˜¯å¦éƒ½å¡«äº†
            if (!q1 || !q2 || !q3 || !q4) {
                alert("âš ï¸ è«‹å…ˆå¡«å¯«å®Œæ‰€æœ‰å¿—é¡˜ï¼ŒæŠ•èƒæ˜¯å¾ˆåš´è‚…çš„ï¼");
                // æ²å‹•åˆ°å•å·å€
                document.getElementById('quiz-section').scrollIntoView({behavior: "smooth"});
                return;
            }

            const userTags = [q1.value, q2.value, q3.value, q4.value];

            // --- æ­¥é©Ÿ A: ç®—å‡ºã€Œç†æƒ³åœ‹å®¶ã€ (åŒ¹é…åº¦æœ€é«˜) ---
            let bestMatch = null;
            let maxScore = -1;

            countries.forEach(country => {
                // è¨ˆç®—é‡ç–Šçš„æ¨™ç±¤æ•¸é‡
                const score = country.tags.filter(tag => userTags.includes(tag)).length;
                if (score > maxScore) {
                    maxScore = score;
                    bestMatch = country;
                }
            });

            // --- æ­¥é©Ÿ B: ç®—å‡ºã€Œå¯¦éš›æŠ•èƒã€ (åŠ æ¬Šéš¨æ©Ÿ) ---
            // ç®—æ³•ï¼šæŠŠæ‰€æœ‰åœ‹å®¶çš„ ticket åŠ ç¸½ï¼Œç„¶å¾Œä¸Ÿä¸€å€‹éš¨æ©Ÿæ•¸
            const totalTickets = countries.reduce((sum, country) => sum + country.ticket, 0);
            let randomPointer = Math.random() * totalTickets;
            let realCountry = null;

            for (const country of countries) {
                randomPointer -= country.ticket;
                if (randomPointer <= 0) {
                    realCountry = country;
                    break;
                }
            }
            
            // å¦‚æœæ²’æŠ“åˆ°ï¼ˆç†è«–ä¸Šä¸æœƒï¼‰ï¼Œå°±é è¨­æœ€å¾Œä¸€å€‹
            if (!realCountry) realCountry = countries[countries.length - 1];

            // --- æ­¥é©Ÿ C: é¡¯ç¤º UI ---
            const modal = document.getElementById('result-modal');
            const loadingView = document.getElementById('loading-view');
            const resultView = document.getElementById('result-view');
            const loadingText = document.getElementById('loading-text');

            // é‡ç½®ç‹€æ…‹
            modal.classList.remove('hidden');
            loadingView.classList.remove('hidden');
            resultView.classList.add('hidden');
            
            // éš¨æ©Ÿ Loading å­—
            loadingText.innerText = loadingTexts[Math.floor(Math.random() * loadingTexts.length)];

            // æ¨¡æ“¬å»¶é² 2.5 ç§’é–‹ç
            setTimeout(() => {
                loadingView.classList.add('hidden');
                resultView.classList.remove('hidden');

                // å¡«å…¥è³‡æ–™
                document.getElementById('ideal-match').innerText = `${bestMatch.flag} ${bestMatch.name} (åŒ¹é…åº¦ ${Math.round((maxScore/4)*100)}%)`;
                
                document.getElementById('real-country-flag').innerText = realCountry.flag;
                document.getElementById('real-country-name').innerText = `${realCountry.name} (${realCountry.id.toUpperCase()})`;
                
                // è¨ˆç®—è©²åœ‹çœŸå¯¦æ©Ÿç‡ %
                const chance = ((realCountry.ticket / totalTickets) * 100).toFixed(2);
                document.getElementById('real-chance').innerText = `å…¨çƒäººå£ä½”æ¯”ï¼š${chance}%`;
                document.getElementById('result-comment').innerText = `${realCountry.comment}`;

                // è¨­å®š Badge é¡è‰²
                const badge = document.getElementById('result-badge');
                badge.innerText = realCountry.rank;
                badge.className = "inline-block px-4 py-1 font-black tracking-widest rounded shadow-lg text-sm mb-5 transform -rotate-2 text-white";
                
                if (realCountry.rank === 'SSR') badge.classList.add('bg-yellow-500');
                else if (realCountry.rank === 'SR') badge.classList.add('bg-purple-600');
                else if (realCountry.rank === 'R') badge.classList.add('bg-green-600');
                else badge.classList.add('bg-slate-600'); // N

            }, 2000);
        }

        function closeModal() {
            document.getElementById('result-modal').classList.add('hidden');
        }
    </script>
</body>
</html>