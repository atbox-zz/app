<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 ä¸­è¯æ°‘åœ‹115å¹´å°ˆå±¬æœˆæ›†ç”¢ç”Ÿå™¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lunar-javascript/1.6.12/lunar.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft JhengHei', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        .content {
            display: flex;
            min-height: 600px;
        }
        .sidebar {
            width: 350px;
            background: #f8f9fa;
            padding: 30px;
            overflow-y: auto;
            max-height: calc(100vh - 200px);
        }
        .main {
            flex: 1;
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .section {
            margin-bottom: 25px;
        }
        .section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 18px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }
        input[type="text"],
        input[type="number"],
        input[type="file"],
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border 0.3s;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        input[type="range"] {
            width: 100%;
            margin-top: 5px;
        }
        .slider-value {
            color: #667eea;
            font-weight: bold;
            margin-left: 10px;
        }
        .radio-group {
            display: flex;
            gap: 15px;
            margin-top: 8px;
        }
        .radio-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
        }
        .checkbox-group label {
            margin: 0;
            font-weight: normal;
        }
        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        button:active {
            transform: translateY(0);
        }
        #preview {
            max-width: 100%;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .info {
            text-align: center;
            color: #666;
            padding: 40px;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
        }
        .download-btn {
            margin-top: 20px;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“… 2026 ä¸­è¯æ°‘åœ‹115å¹´å°ˆå±¬æœˆæ›†ç”¢ç”Ÿå™¨</h1>
            <p>ä¸Šå‚³åœ–ç‰‡ï¼Œèª¿æ•´åƒæ•¸ï¼Œç”Ÿæˆä½ çš„å°ˆå±¬å¹´æ›†ï¼</p>
        </div>
        <div class="content">
            <div class="sidebar">
                <div class="section">
                    <h3>1. åœ–ç‰‡ä¸Šå‚³</h3>
                    <input type="file" id="imageUpload" accept="image/*">
                    <div class="form-group" style="margin-top: 15px;">
                        <label>åœ–ç‰‡ä½ç½®</label>
                        <div class="radio-group">
                            <label><input type="radio" name="imgPosition" value="top" checked> ä¸Šæ–¹</label>
                            <label><input type="radio" name="imgPosition" value="background"> åº•ç¨¿</label>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>2. æ¨™é¡Œè¨­å®š</h3>
                    <input type="text" id="customTitle" value="ä¸­è¯æ°‘åœ‹115å¹´ æ­²æ¬¡ä¸™åˆ" placeholder="è¼¸å…¥æ¨™é¡Œ">
                </div>

                <div class="section">
                    <h3>3. ç‰ˆé¢è¨­å®š</h3>
                    <div class="form-group">
                        <label>å¯¬åº¦ (åƒç´ )</label>
                        <input type="number" id="canvasWidth" value="2480" step="100">
                    </div>
                    <div class="form-group">
                        <label>é«˜åº¦ (åƒç´ )</label>
                        <input type="number" id="canvasHeight" value="3508" step="100">
                    </div>
                </div>

                <div class="section">
                    <h3>4. æ’ç‰ˆå¾®èª¿</h3>
                    <div class="form-group">
                        <label>åœ–ç‰‡ä½”æ¯” <span class="slider-value" id="imgRatioValue">45%</span></label>
                        <input type="range" id="imgRatio" min="30" max="70" value="45">
                    </div>
                    <div class="form-group">
                        <label>å·¦å³é‚Šç•Œ <span class="slider-value" id="marginXValue">100</span></label>
                        <input type="range" id="marginX" min="50" max="300" value="100">
                    </div>
                    <div class="form-group">
                        <label>ä¸‹æ–¹é‚Šç•Œ <span class="slider-value" id="marginYValue">100</span></label>
                        <input type="range" id="marginY" min="50" max="300" value="100">
                    </div>
                    <div class="form-group">
                        <label>æœˆä»½å·¦å³é–“è· <span class="slider-value" id="gapXValue">40</span></label>
                        <input type="range" id="gapX" min="0" max="200" value="40">
                    </div>
                    <div class="form-group">
                        <label>æœˆä»½ä¸Šä¸‹é–“è· <span class="slider-value" id="gapYValue">0</span></label>
                        <input type="range" id="gapY" min="0" max="200" value="0">
                    </div>
                    <div class="form-group">
                        <label>æ¨™é¡Œèˆ‡æ—¥æœŸé–“è· <span class="slider-value" id="titleDateGapValue">50</span></label>
                        <input type="range" id="titleDateGap" min="10" max="100" value="50">
                    </div>
                </div>

                <div class="section">
                    <h3>5. æœˆä»½æ¨£å¼</h3>
                    <div class="form-group">
                        <label>æœˆä»½é¡¯ç¤º</label>
                        <div class="radio-group">
                            <label><input type="radio" name="monthStyle" value="number" checked> æ•¸å­—</label>
                            <label><input type="radio" name="monthStyle" value="english"> è‹±æ–‡</label>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="showBorder">
                        <label for="showBorder">é¡¯ç¤ºæœˆä»½æ¡†ç·š</label>
                    </div>
                </div>

                <div class="section">
                    <h3>6. å­—é«”å¤§å°</h3>
                    <div class="form-group">
                        <label>æ¨™é¡Œå¤§å°</label>
                        <input type="number" id="titleSize" value="80" step="5">
                    </div>
                    <div class="form-group">
                        <label>æœˆä»½æ¨™é¡Œå¤§å°</label>
                        <input type="number" id="monthSize" value="50" step="5">
                    </div>
                    <div class="form-group">
                        <label>æ—¥æœŸæ•¸å­—å¤§å°</label>
                        <input type="number" id="dateSize" value="40" step="5">
                    </div>
                    <div class="form-group">
                        <label>è¾²æ›†/ç¯€æ—¥å¤§å°</label>
                        <input type="number" id="lunarSize" value="24" step="2">
                    </div>
                </div>

                <button onclick="generateCalendar()">ç”Ÿæˆæœˆæ›†</button>
            </div>

            <div class="main">
                <div id="output" class="info">
                    <p>ğŸ‘ˆ è«‹åœ¨å·¦å´è¨­å®šåƒæ•¸å¾Œé»æ“Šã€Œç”Ÿæˆæœˆæ›†ã€æŒ‰éˆ•</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å‡æ—¥è³‡æ–™
        const HOLIDAYS_2026 = {
            '1-1': 'å…ƒæ—¦', '2-16': 'é™¤å¤•', '2-17': 'åˆä¸€', '2-18': 'åˆäºŒ',
            '2-19': 'åˆä¸‰', '2-20': 'åˆå››', '2-21': 'åˆäº”', '2-27': 'åˆå',
            '2-28': '228', '4-3': 'åå…­', '4-4': 'å…’ç«¥', '4-5': 'æ¸…æ˜',
            '4-6': 'åä¹', '5-1': 'å‹å‹•', '6-19': 'ç«¯åˆ', '9-25': 'ä¸­ç§‹',
            '10-9': 'å»¿ä¹', '10-10': 'åœ‹æ…¶', '10-25': 'å…‰å¾©', '10-26': 'åä¸ƒ',
            '12-25': 'è¡Œæ†²'
        };

        // ç¯€æ°£è³‡æ–™
        const SOLAR_TERMS_2026 = {
            '1-5': 'å°å¯’', '1-20': 'å¤§å¯’', '2-4': 'ç«‹æ˜¥', '2-18': 'é›¨æ°´',
            '3-5': 'é©šèŸ„', '3-20': 'æ˜¥åˆ†', '4-4': 'æ¸…æ˜', '4-20': 'ç©€é›¨',
            '5-5': 'ç«‹å¤', '5-21': 'å°æ»¿', '6-5': 'èŠ’ç¨®', '6-21': 'å¤è‡³',
            '7-7': 'å°æš‘', '7-22': 'å¤§æš‘', '8-7': 'ç«‹ç§‹', '8-23': 'è™•æš‘',
            '9-7': 'ç™½éœ²', '9-23': 'ç§‹åˆ†', '10-8': 'å¯’éœ²', '10-23': 'éœœé™',
            '11-7': 'ç«‹å†¬', '11-22': 'å°é›ª', '12-7': 'å¤§é›ª', '12-21': 'å†¬è‡³'
        };

        const MONTH_NAMES_EN = ['', 'January', 'February', 'March', 'April', 'May', 'June',
                                'July', 'August', 'September', 'October', 'November', 'December'];

        // æ»‘æ¡¿æ•¸å€¼æ›´æ–°
        document.querySelectorAll('input[type="range"]').forEach(slider => {
            const valueSpan = document.getElementById(slider.id + 'Value');
            slider.addEventListener('input', () => {
                const unit = slider.id === 'imgRatio' ? '%' : '';
                valueSpan.textContent = slider.value + unit;
            });
        });

        // è¾²æ›†è½‰æ›
        function getLunarText(year, month, day) {
            const key = `${month}-${day}`;
            
            // å„ªå…ˆé¡¯ç¤ºç¯€æ°£
            if (SOLAR_TERMS_2026[key]) return SOLAR_TERMS_2026[key];
            
            // ä½¿ç”¨ lunar-javascript è½‰æ›è¾²æ›†
            const lunar = Lunar.fromDate(new Date(year, month - 1, day));
            const lunarDay = lunar.getDay();
            const lunarMonth = lunar.getMonth();
            
            // ç‰¹æ®Šç¯€æ—¥
            if (lunarMonth === 1 && lunarDay === 1) return 'æ˜¥ç¯€';
            if (lunarMonth === 5 && lunarDay === 5) return 'ç«¯åˆ';
            if (lunarMonth === 8 && lunarDay === 15) return 'ä¸­ç§‹';
            
            // åˆä¸€é¡¯ç¤ºæœˆä»½
            if (lunarDay === 1) {
                const monthNames = ['', 'æ­£', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'ä¸ƒ', 'å…«', 'ä¹', 'å', 'å†¬', 'è‡˜'];
                return monthNames[lunarMonth] + 'æœˆ';
            }
            
            // é¡¯ç¤ºè¾²æ›†æ—¥æœŸ
            const dayNames = ['', 'åˆä¸€', 'åˆäºŒ', 'åˆä¸‰', 'åˆå››', 'åˆäº”', 'åˆå…­', 'åˆä¸ƒ', 'åˆå…«', 'åˆä¹', 'åˆå',
                            'åä¸€', 'åäºŒ', 'åä¸‰', 'åå››', 'åäº”', 'åå…­', 'åä¸ƒ', 'åå…«', 'åä¹', 'äºŒå',
                            'å»¿ä¸€', 'å»¿äºŒ', 'å»¿ä¸‰', 'å»¿å››', 'å»¿äº”', 'å»¿å…­', 'å»¿ä¸ƒ', 'å»¿å…«', 'å»¿ä¹', 'ä¸‰å'];
            return dayNames[lunarDay];
        }

        // å–å¾—æœˆä»½å¤©æ•¸
        function getDaysInMonth(year, month) {
            return new Date(year, month, 0).getDate();
        }

        // å–å¾—æœˆä»½ç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå¹¾ (0=æ—¥)
        function getFirstDayOfMonth(year, month) {
            return new Date(year, month - 1, 1).getDay();
        }

        async function generateCalendar() {
            const output = document.getElementById('output');
            output.innerHTML = '<div class="loading">ğŸ¨ æ­£åœ¨ç¹ªè£½æœˆæ›†...</div>';

            // å–å¾—åƒæ•¸
            const width = parseInt(document.getElementById('canvasWidth').value);
            const height = parseInt(document.getElementById('canvasHeight').value);
            const imgRatio = parseInt(document.getElementById('imgRatio').value) / 100;
            const marginX = parseInt(document.getElementById('marginX').value);
            const marginY = parseInt(document.getElementById('marginY').value);
            const gapX = parseInt(document.getElementById('gapX').value);
            const gapY = parseInt(document.getElementById('gapY').value);
            const titleDateGap = parseInt(document.getElementById('titleDateGap').value);
            const titleSize = parseInt(document.getElementById('titleSize').value);
            const monthSize = parseInt(document.getElementById('monthSize').value);
            const dateSize = parseInt(document.getElementById('dateSize').value);
            const lunarSize = parseInt(document.getElementById('lunarSize').value);
            const customTitle = document.getElementById('customTitle').value;
            const monthStyle = document.querySelector('input[name="monthStyle"]:checked').value;
            const showBorder = document.getElementById('showBorder').checked;
            const imgPosition = document.querySelector('input[name="imgPosition"]:checked').value;

            // å»ºç«‹ç•«å¸ƒ
            const canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            const ctx = canvas.getContext('2d');
            
            // ç™½è‰²èƒŒæ™¯
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, width, height);

            let targetImgH = 0;

            // è™•ç†åœ–ç‰‡
            const fileInput = document.getElementById('imageUpload');
            if (fileInput.files.length > 0) {
                const img = await loadImage(fileInput.files[0]);
                
                if (imgPosition === 'background') {
                    // åº•ç¨¿æ¨¡å¼
                    const ratio = Math.max(width / img.width, height / img.height);
                    const newW = img.width * ratio;
                    const newH = img.height * ratio;
                    const x = (width - newW) / 2;
                    const y = (height - newH) / 2;
                    
                    ctx.globalAlpha = 0.6;
                    ctx.drawImage(img, x, y, newW, newH);
                    ctx.globalAlpha = 1.0;
                    targetImgH = 0;
                } else {
                    // ä¸Šæ–¹æ¨¡å¼
                    targetImgH = height * imgRatio;
                    const ratio = width / img.width;
                    const newH = img.height * ratio;
                    
                    if (newH > targetImgH) {
                        ctx.drawImage(img, 0, 0, width, targetImgH);
                    } else {
                        ctx.drawImage(img, 0, 0, width, newH);
                    }
                }
            }

            // ç¹ªè£½æ¨™é¡Œ
            ctx.fillStyle = 'black';
            ctx.font = `${titleSize}px "Microsoft JhengHei", sans-serif`;
            ctx.textAlign = 'center';
            const titleY = targetImgH > 0 ? targetImgH + 50 : 50;
            ctx.fillText(customTitle, width / 2, titleY);

            // æœˆæ›†å€åŸŸ
            const calStartY = titleY + titleSize + 50;
            const calAreaH = height - calStartY - marginY;
            const calAreaW = width - (2 * marginX);
            const cols = 3, rows = 4;
            const cellW = (calAreaW - (cols - 1) * gapX) / cols;
            const cellH = (calAreaH - (rows - 1) * gapY) / rows;

            // ç¹ªè£½12å€‹æœˆ
            for (let m = 1; m <= 12; m++) {
                const rowIdx = Math.floor((m - 1) / cols);
                const colIdx = (m - 1) % cols;
                const baseX = marginX + colIdx * (cellW + gapX);
                const baseY = calStartY + rowIdx * (cellH + gapY);

                // æ¡†ç·š
                if (showBorder) {
                    ctx.strokeStyle = 'gray';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(baseX - 10, baseY - 10, cellW + 20, cellH + 20);
                }

                // æœˆä»½æ¨™é¡Œ
                const monthTitle = monthStyle === 'english' ? MONTH_NAMES_EN[m] : `${m}æœˆ`;
                ctx.font = `bold ${monthSize}px "Microsoft JhengHei", sans-serif`;
                ctx.fillStyle = 'black';
                ctx.textAlign = 'center';
                ctx.fillText(monthTitle, baseX + cellW / 2, baseY + monthSize);

                const headerY = baseY + monthSize + titleDateGap;

                // æ˜ŸæœŸæ¨™é¡Œ
                const days = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
                const dayW = cellW / 7;
                ctx.font = `${lunarSize}px "Microsoft JhengHei", sans-serif`;
                
                days.forEach((d, i) => {
                    ctx.fillStyle = (i === 0 || i === 6) ? 'red' : 'black';
                    ctx.fillText(d, baseX + i * dayW + dayW / 2, headerY);
                });

                // æ—¥æœŸç¶²æ ¼
                const firstDay = getFirstDayOfMonth(2026, m);
                const daysInMonth = getDaysInMonth(2026, m);
                let currentY = headerY + 40;
                const lineSpacing = (cellH - (headerY - baseY) - 20) / 6;

                let day = 1;
                for (let week = 0; week < 6 && day <= daysInMonth; week++) {
                    for (let i = 0; i < 7; i++) {
                        if (week === 0 && i < firstDay) continue;
                        if (day > daysInMonth) break;

                        const dx = baseX + i * dayW + dayW / 2;
                        const key = `${m}-${day}`;
                        const isWeekend = (i === 0 || i === 6);
                        const isHoliday = HOLIDAYS_2026[key] !== undefined;
                        const isSolarTerm = SOLAR_TERMS_2026[key] !== undefined;

                        // åœ‹æ›†æ—¥æœŸ
                        ctx.font = `bold ${dateSize}px "Microsoft JhengHei", sans-serif`;
                        ctx.fillStyle = (isWeekend || isHoliday) ? 'red' : 'black';
                        ctx.textAlign = 'center';
                        ctx.fillText(day.toString(), dx, currentY);

                        // è¾²æ›†/ç¯€æ—¥
                        let lunarText = getLunarText(2026, m, day);
                        if (HOLIDAYS_2026[key]) lunarText = HOLIDAYS_2026[key];

                        ctx.font = `${lunarSize}px "Microsoft JhengHei", sans-serif`;
                        if (isSolarTerm) {
                            ctx.fillStyle = 'green';
                        } else if (isWeekend || isHoliday) {
                            ctx.fillStyle = 'red';
                        } else {
                            ctx.fillStyle = 'gray';
                        }
                        ctx.fillText(lunarText, dx, currentY + dateSize);

                        day++;
                    }
                    currentY += lineSpacing;
                }
            }

            // é¡¯ç¤ºçµæœ
            const img = canvas.toDataURL('image/jpeg', 0.95);
            output.innerHTML = `
                <img id="preview" src="${img}" alt="æœˆæ›†é è¦½">
                <button class="download-btn" onclick="downloadCalendar()">ğŸ“¥ ä¸‹è¼‰é«˜è§£æåº¦æœˆæ›†</button>
            `;
            window.generatedImage = img;
        }

        function loadImage(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => resolve(img);
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }

        function downloadCalendar() {
            const link = document.createElement('a');
            link.download = '2026_Custom_Calendar.jpg';
            link.href = window.generatedImage;
            link.click();
        }
    </script>
</body>
</html>