<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<title>六十四卦八卦圖</title>
<style>
  body {
    margin: 0;
    background: #fafafa;
    overflow: hidden;
  }
  svg {
    width: 100vw;
    height: 100vh;
    touch-action: none;
    background: radial-gradient(circle, #ffffff, #e0e0e0);
  }
  text {
    font-family: "Noto Sans TC", sans-serif;
    text-anchor: middle;
    dominant-baseline: middle;
  }
  .guaName {
    font-size: 10px;
    font-weight: bold;
    fill: #222;
  }
  .guaLines {
    font-size: 14px;
    fill: #000;
  }
</style>
</head>
<body>

<svg id="guaSVG" viewBox="-500 -500 1000 1000">
  <g id="guaContainer"></g>
</svg>

<script>
// 六十四卦名稱與二進制碼（0=⚋陰，1=⚊陽，自上而下）
const gua64 = [
  ["坤", "000000"],["復", "000001"],["師", "000010"],["臨", "000011"],
  ["謙", "000100"],["明夷", "000101"],["升", "000110"],["泰", "000111"],
  ["豫", "001000"],["震", "001001"],["解", "001010"],["歸妹", "001011"],
  ["小過","001100"],["豐", "001101"],["恆", "001110"],["大壯", "001111"],
  ["比", "010000"],["屯", "010001"],["坎", "010010"],["節", "010011"],
  ["蹇", "010100"],["既濟", "010101"],["井", "010110"],["需", "010111"],
  ["萃", "011000"],["隨", "011001"],["困", "011010"],["澤", "011011"],
  ["咸", "011100"],["革", "011101"],["大過", "011110"],["夬", "011111"],
  ["剝", "100000"],["頤", "100001"],["蒙", "100010"],["損", "100011"],
  ["艮", "100100"],["賁", "100101"],["蠱", "100110"],["大畜", "100111"],
  ["晉", "101000"],["噬嗑", "101001"],["未濟", "101010"],["睽", "101011"],
  ["旅", "101100"],["火", "101101"],["鼎", "101110"],["大有", "101111"],
  ["觀", "110000"],["益", "110001"],["渙", "110010"],["中孚", "110011"],
  ["漸", "110100"],["家人", "110101"],["巽", "110110"],["小畜", "110111"],
  ["否", "111000"],["無妄", "111001"],["訟", "111010"],["履", "111011"],
  ["遯", "111100"],["同人", "111101"],["姤", "111110"],["乾", "111111"]
];
const gua = [
  ["坤為地", "000000"],["地雷復", "000001"],["地水師", "000010"],["地澤臨", "000011"],
  ["地山謙", "000100"],["地火明夷", "000101"],["地風升", "000110"],["地天泰", "000111"],
  ["雷地豫", "001000"],["震為雷", "001001"],["雷水解", "001010"],["雷澤歸妹", "001011"],
  ["雷山小過", "001100"],["雷火豐", "001101"],["雷風恆", "001110"],["雷天大壯", "001111"],
  ["水地比", "010000"],["水雷屯", "010001"],["坎為水", "010010"],["水澤節", "010011"],
  ["水山蹇", "010100"],["水火既濟", "010101"],["水風井", "010110"],["水天需", "010111"],
  ["澤地萃", "011000"],["澤雷隨", "011001"],["澤水困", "011010"],["兌為澤", "011011"],
  ["澤山咸", "011100"],["澤火革", "011101"],["澤風大過", "011110"],["澤天夬", "011111"],
  ["山地剝", "100000"],["山雷頤", "100001"],["山水蒙", "100010"],["山澤損", "100011"],
  ["艮為山", "100100"],["山火賁", "100101"],["山風蠱", "100110"],["山天大畜", "100111"],
  ["火地晉", "101000"],["火雷噬嗑", "101001"],["火水未濟", "101010"],["火澤睽", "101011"],
  ["火山旅", "101100"],["離為火", "101101"],["火風鼎", "101110"],["火天大有", "101111"],
  ["風地觀", "110000"],["風雷益", "110001"],["風水渙", "110010"],["風澤中孚", "110011"],
  ["風山漸", "110100"],["風火家人", "110101"],["巽為風", "110110"],["風天小畜", "110111"],
  ["天地否", "111000"],["天雷無妄", "111001"],["天水訟", "111010"],["天澤履", "111011"],
  ["天山遯", "111100"],["天火同人", "111101"],["天風姤", "111110"],["乾為天", "111111"]
];

// 繪製
const container = document.getElementById("guaContainer");
const radius = 400;
gua64.forEach((gua, i) => {
  const angle = (i / gua64.length) * Math.PI * 2 - Math.PI / 2;
  const x = radius * Math.cos(angle);
  const y = radius * Math.sin(angle);

  const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
  g.setAttribute("transform", `translate(${x},${y})`);

  // 卦名
  const nameText = document.createElementNS("http://www.w3.org/2000/svg", "text");
  nameText.setAttribute("class", "guaName");
  nameText.setAttribute("y", -40);
  nameText.textContent = gua[0];
  g.appendChild(nameText);

  // 六爻
  const lines = gua[1].split("").map(v => v === "1" ? "⚊" : "⚋");
  lines.forEach((line, idx) => {
    const lineText = document.createElementNS("http://www.w3.org/2000/svg", "text");
    lineText.setAttribute("class", "guaLines");
    lineText.setAttribute("y", idx * 16);
    lineText.textContent = line;
    g.appendChild(lineText);
  });

  container.appendChild(g);
});

// 手機拖動與縮放
let svg = document.getElementById("guaSVG");
let viewBox = { x: -500, y: -500, w: 1000, h: 1000 };
let isPanning = false, startX, startY;

svg.addEventListener("pointerdown", e => {
  isPanning = true;
  startX = e.clientX;
  startY = e.clientY;
});
svg.addEventListener("pointermove", e => {
  if (!isPanning) return;
  let dx = (e.clientX - startX) * (viewBox.w / svg.clientWidth);
  let dy = (e.clientY - startY) * (viewBox.h / svg.clientHeight);
  viewBox.x -= dx;
  viewBox.y -= dy;
  startX = e.clientX;
  startY = e.clientY;
  updateViewBox();
});
svg.addEventListener("pointerup", () => isPanning = false);
svg.addEventListener("wheel", e => {
  e.preventDefault();
  let scale = e.deltaY > 0 ? 1.1 : 0.9;
  let mx = viewBox.x + (e.offsetX / svg.clientWidth) * viewBox.w;
  let my = viewBox.y + (e.offsetY / svg.clientHeight) * viewBox.h;
  viewBox.w *= scale;
  viewBox.h *= scale;
  viewBox.x = mx - (e.offsetX / svg.clientWidth) * viewBox.w;
  viewBox.y = my - (e.offsetY / svg.clientHeight) * viewBox.h;
  updateViewBox();
});

function updateViewBox() {
  svg.setAttribute("viewBox", `${viewBox.x} ${viewBox.y} ${viewBox.w} ${viewBox.h}`);
}
</script>

</body>
</html>
